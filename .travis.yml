language: node_js
dist: trusty
sudo: required

addons:
  apt:
    packages:
    - g++-4.8
    - gcc-4.8
    # - tree

services:
  - mysql
  - postgresql

node_js:
  - "4.3.2"
  # - "4"
  # - "5"
  # - "6"
  # - "7"
  # - "node"
  # - "iojs"

env:
  # - DB=sqlite3
  # - DB=mysql
  # - DB=mysql2
  # - DB=pg
  # - DB=oracledb ORACLE_HOME=/u01/app/oracle/product/11.2.0/xe ORACLE_SID=XE OCI_LIB_DIR=/u01/app/oracle/product/11.2.0/xe/lib LD_LIBRARY_PATH=/u01/app/oracle/product/11.2.0/xe/lib
  - DB=strong-oracle ORACLE_HOME=/u01/app/oracle/product/11.2.0/xe ORACLE_SID=XE OCI_LIB_DIR=/u01/app/oracle/product/11.2.0/xe/lib OCI_HOME=/u01/app/oracle/product/11.2.0/xe/lib LD_LIBRARY_PATH=/u01/app/oracle/product/11.2.0/xe/lib

before_install:
  - sh -c "if [ '$DB' = 'mysql' ]; then mysql -e 'CREATE DATABASE IF NOT EXISTS test_mysql;'; fi"
  - sh -c "if [ '$DB' = 'mysql2' ]; then mysql -e 'CREATE DATABASE IF NOT EXISTS test_mysql2;'; fi"
  - sh -c "if [ '$DB' = 'pg' ]; then psql -c 'create database test_pg;' -U postgres; fi"
  - sh -c "if [ '$DB' = 'oracledb' ]; then wget https://raw.githubusercontent.com/Vincit/travis-oracledb-xe/master/accept_the_license_agreement_for_oracledb_xe_11g_and_install.sh; fi"
  - sh -c "if [ '$DB' = 'oracledb' ]; then bash ./accept_the_license_agreement_for_oracledb_xe_11g_and_install.sh; fi"
  - sh -c "if [ '$DB' = 'strong-oracle' ]; then wget https://raw.githubusercontent.com/Vincit/travis-oracledb-xe/master/accept_the_license_agreement_for_oracledb_xe_11g_and_install.sh; fi"
  - sh -c "if [ '$DB' = 'strong-oracle' ]; then bash ./accept_the_license_agreement_for_oracledb_xe_11g_and_install.sh; fi"
  # - tree -d /u01/app/oracle/product/11.2.0/xe/

before_script:
  - sh -c "npm install $DB"

matrix:
  allow_failures:
    - node_js: "iojs"
